# –¢–ó/PRD: ¬´–ó–∞–∫–∞–∑ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è¬ª ‚Äî UI + –ª–æ–≥–∏–∫–∞ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ Exolynk

## 0) –ö–æ–Ω—Ç–µ–∫—Å—Ç –∏ —Ü–µ–ª—å
–°–æ–±—Ä–∞—Ç—å MVP-–ø—Ä–æ—Ü–µ—Å—Å ¬´–ó–∞–∫–∞–∑ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è¬ª –Ω–∞ **Exolynk** (low‚Äëcode –Ω–∞ PostgreSQL) —Å —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º —Ä–æ–ª–µ–π (**Sales**, **Manager**, **Logistics**, **System**), –µ–¥–∏–Ω—ã–º –∫–∞–Ω–±–∞–Ω–æ–º, –∫–∞—Ä—Ç–æ—á–∫–æ–π –∑–∞–∫–∞–∑–∞ –≤ —Å–≤–µ—Ç–ª–æ–π —Ç–µ–º–µ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è–º–∏.

–ó–∞–¥–∞—á–∞ ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- —Ä–∞–∑–¥–µ–ª–∏—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ **—Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏** –ø–æ —Ä–æ–ª—è–º (—Å—Ç–∞—Ç—É—Å—ã –≤—ã—á–∏—Å–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–∞);
- –∑–∞—â–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è (—Ä–µ–∂–∏–º ¬´–ò–∑–º–µ–Ω–∏—Ç—å¬ª + –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ);
- —Å–ª–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏.

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Exolynk:**
- Getting started: https://exolynk.app/docs/docs/usage/getting-started/
- Rune API: https://exolynk.app/docs/docs/api/rune/
- REST API: https://exolynk.app/docs/docs/api/rest/
- Templates: https://exolynk.com/en/templates/

---

## 1) –¢–µ—Ä–º–∏–Ω—ã
- **–°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞** (–∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª, —Å—á–∏—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞): **–û—Ç–∫—Ä—ã—Ç ‚Üí –ò—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è ‚Üí –ó–∞–∫—Ä—ã—Ç**.
- **–°–æ—Å—Ç–æ—è–Ω–∏–µ (–∫–∞–Ω–±–∞–Ω‚Äë–∫–æ–ª–æ–Ω–∫–∞)**: **–ù–æ–≤—ã–π ‚Üí –ù–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ‚Üí –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è ‚Üí –ì–æ—Ç–æ–≤–æ –∫ –æ—Ç–≥—Ä—É–∑–∫–µ ‚Üí –ó–∞–∫–∞–∑ –∑–∞–∫—Ä—ã—Ç**.  
  –§–∏–Ω–∞–ª—å–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞ –æ–¥–Ω–∞: **–ó–∞–∫–∞–∑ –∑–∞–∫—Ä—ã—Ç**. –ù–∞ –∫–∞—Ä—Ç–æ—á–∫–µ –≤ –Ω–µ–π –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –±–µ–π–¥–∂: üü¶ **–í—ã–ø–æ–ª–Ω–µ–Ω** (—É—Å–ø–µ—Ö) –∏–ª–∏ üî¥ **–ó–∞–∫—Ä—ã—Ç –Ω–µ—É—Å–ø–µ—à–Ω–æ** (–Ω–µ—É—Å–ø–µ—Ö).
- **–õ–æ–≥–∏—Å—Ç–∏–∫–∞ (`shipment_state`)**: **–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è ‚Üí –ì–æ—Ç–æ–≤–æ –∫ –æ—Ç–≥—Ä—É–∑–∫–µ ‚Üí –û—Ç–≥—Ä—É–∂–µ–Ω–æ** (—Å–ª—É–∂–µ–±–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –∫–∞—Ä—Ç–æ—á–∫–∏, —É—á–∞—Å—Ç–≤—É—é—Ç –≤ –ª–æ–≥–∏–∫–µ, –Ω–æ –Ω–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–∞–Ω–±–∞–Ω‚Äë–∫–æ–ª–æ–Ω–∫–∏).
- **–û–ø–ª–∞—Ç–∞ (`payment_state`)**: **–ù–µ—Ç / –î–∞**.

---

## 2) –†–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞ (—É–ø—Ä–∞–≤–ª—è—é—Ç —Ç–æ–ª—å–∫–æ –°–æ—Å—Ç–æ—è–Ω–∏—è–º–∏)
| –†–æ–ª—å | –†–∞–∑—Ä–µ—à—ë–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã |
|---|---|
| **Sales** | **–ù–æ–≤—ã–π ‚Üí –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è** (–µ—Å–ª–∏ —Å—É–º–º–∞ ‚â§ 10‚ÄØ000) ‚Ä¢ **–ù–æ–≤—ã–π ‚Üí –ù–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ** (–µ—Å–ª–∏ —Å—É–º–º–∞ > 10‚ÄØ000) ‚Ä¢ (–æ–ø—Ü.) ¬´–ó–∞–∫–∞–∑ –∑–∞–∫—Ä—ã—Ç¬ª ¬∑ *–Ω–µ—É—Å–ø–µ—à–Ω–æ* |
| **Manager** | **–ù–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ‚Üí –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è** (–∫–Ω–æ–ø–∫–∞ **¬´–†–∞–∑—Ä–µ—à–∏—Ç—å –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—é¬ª**) ‚Ä¢ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—É –Ω–∞ —à–∞–≥–µ ¬´–ì–æ—Ç–æ–≤–æ –∫ –æ—Ç–≥—Ä—É–∑–∫–µ¬ª |
| **Logistics** | **–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è ‚Üí –ì–æ—Ç–æ–≤–æ –∫ –æ—Ç–≥—Ä—É–∑–∫–µ** |
| **System** | –°—Ç–∞–≤–∏—Ç **–û—Ç–≥—Ä—É–∂–µ–Ω–æ** –ø–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã ‚Ä¢ –ü–µ—Ä–µ–≤–æ–¥–∏—Ç –≤ **¬´–ó–∞–∫–∞–∑ –∑–∞–∫—Ä—ã—Ç (—É—Å–ø–µ—à–Ω–æ)¬ª** –ø—Ä–∏ `shipment=–û—Ç–≥—Ä—É–∂–µ–Ω–æ` –∏ `payment=–î–∞` ‚Ä¢ –í—ã—á–∏—Å–ª—è–µ—Ç –°—Ç–∞—Ç—É—Å: –û—Ç–∫—Ä—ã—Ç/–ò—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è/–ó–∞–∫—Ä—ã—Ç |

–í—Å–µ –≤–∏–¥—è—Ç **–æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–∞–Ω–±–∞–Ω**, –Ω–æ –¥–≤–∏–≥–∞—Ç—å –º–æ–≥—É—Ç —Ç–æ–ª—å–∫–æ ¬´—Å–≤–æ–∏¬ª —à–∞–≥–∏ (–∫–Ω–æ–ø–∫–∏ –≤–Ω–µ –ø—Ä–∞–≤ ‚Äî –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã).

---

## 3) –î–∞–Ω–Ω—ã–µ (–º–æ–¥–µ–ª–∏ –∏ –ø–æ–ª—è)

### 3.1 Model: `order`
- `id` (uuid)
- `number` (text, –∞–≤—Ç–æ–Ω—É–º–µ—Ä–∞—Ç–æ—Ä)
- `client_id` (uuid, FK ‚Üí `client`)
- `created_at` (timestamptz, –¥–µ—Ñ–æ–ª—Ç NOW)
- `status` (enum: `OPEN|EXECUTION|CLOSED`) ‚Äî **—Å—á–∏—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞**
- `state` (enum: `NEW|APPROVAL|PICKING|READY|CLOSED`) ‚Äî **–∫–∞–Ω–±–∞–Ω**
- `shipment_state` (enum: `PICKING|READY|SHIPPED|null`)
- `payment_state` (enum: `NO|YES`)
- `amount_total` (numeric(14,2))
- `closed_success` (bool|null) ‚Äî `true` = –≤—ã–ø–æ–ª–Ω–µ–Ω, `false` = –∑–∞–∫—Ä—ã—Ç –Ω–µ—É—Å–ø–µ—à–Ω–æ
- `closed_reason` (text|null)
- `ship_date` (date|null) ‚Äî –Ω–∞–∑–Ω–∞—á–∞–µ—Ç Logistics
- `comment` (text|null)
- `created_by` (uuid)

### 3.2 Model: `order_item`
- `id` (uuid)
- `order_id` (uuid, FK)
- `sku` (text, –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω)
- `name` (text)
- `qty` (numeric(14,3))
- `price` (numeric(14,2))
- `amount` (generated always `qty*price`)

### 3.3 Model: `client`
- –±–∞–∑–æ–≤—ã–µ –ø–æ–ª—è (–∏–º—è, –∫–æ–Ω—Ç–∞–∫—Ç—ã)

**–ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–π** ‚Äî `snake_case`. –ó–Ω–∞—á–µ–Ω–∏—è enum ‚Äî CAPS, –∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ.

---

## 4) –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã

### 4.1 View: `orders_kanban`
- –ö–æ–ª–æ–Ω–∫–∏: **–ù–æ–≤—ã–π | –ù–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ | –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è | –ì–æ—Ç–æ–≤–æ –∫ –æ—Ç–≥—Ä—É–∑–∫–µ | –ó–∞–∫–∞–∑ –∑–∞–∫—Ä—ã—Ç**.  
- –ö–∞—Ä—Ç–æ—á–∫–∞ –≤ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –∫–æ–ª–æ–Ω–∫–µ –∏–º–µ–µ—Ç –±–µ–π–¥–∂: üü¶ **–í—ã–ø–æ–ª–Ω–µ–Ω** (—É—Å–ø–µ—Ö) / üî¥ **–ù–µ—É—Å–ø–µ—à–Ω–æ** (–ø—Ä–æ–≤–∞–ª).
- –§–∏–ª—å—Ç—Ä—ã: ¬´–ú–æ–∏¬ª, ¬´–í—Å–µ¬ª, –±—ã—Å—Ç—Ä—ã–µ –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º –∏ –ø–æ —Å—Ç–∞—Ç—É—Å—É (–û—Ç–∫—Ä—ã—Ç/–ò—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è/–ó–∞–∫—Ä—ã—Ç).

### 4.2 User Layout: `order_detail`
–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞, –∫–æ–º–ø–∞–∫—Ç–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞:
- —à–∞–ø–∫–∞: –ó–∞–≥–æ–ª–æ–≤–æ–∫ + –º–µ—Ç–∞ `‚Ññ` –∏ `–°–æ–∑–¥–∞–Ω`; –∫–Ω–æ–ø–∫–∏: **–ò–∑–º–µ–Ω–∏—Ç—å** / **–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è**;
- **–ø—Ä–æ–≥—Ä–µ—Å—Å‚Äë–±–∞—Ä —Å–æ—Å—Ç–æ—è–Ω–∏–π** (–æ–¥–∏–Ω –±–ª–æ–∫: –ù–æ–≤—ã–π ‚Üí –ù–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ‚Üí –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è ‚Üí –ì–æ—Ç–æ–≤–æ –∫ –æ—Ç–≥—Ä—É–∑–∫–µ ‚Üí –ó–∞–∫–∞–∑ –∑–∞–∫—Ä—ã—Ç);
- –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ –ø–æ–ª—è –≤ –ª–∏–Ω–∏—é: **–ö–ª–∏–µ–Ω—Ç**, **–î–∞—Ç–∞ –æ—Ç–≥—Ä—É–∑–∫–∏ (–ª–æ–≥–∏—Å—Ç–∏–∫–∞)** [readonly], **–û–ø–ª–∞—Ç–∞** [readonly];
- —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–∑–∏—Ü–∏–π (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Å–∫—Ä–æ–ª–ª): **–ê—Ä—Ç–∏–∫—É–ª | –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ | –ö–æ–ª‚Äë–≤–æ | –¶–µ–Ω–∞ | –°—É–º–º–∞ | √ó**;  
  ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ ‚Äî —Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ **–ò–∑–º–µ–Ω–∏—Ç—å** (–∫–Ω–æ–ø–∫–∞ ¬´+¬ª –≤–Ω–∏–∑—É —Å–ø–∏—Å–∫–∞);
- –Ω–∏–∂–Ω—è—è –µ–¥–∏–Ω–∞—è –ø–ª–∞—à–∫–∞ –Ω–∞ 2 —Ä–∞–≤–Ω—ã—Ö –±–ª–æ–∫–∞: **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π** (textarea —Å –ø–ª–µ–π—Å—Ö–æ–ª–¥–µ—Ä–æ–º) —Å–ª–µ–≤–∞, **–°—É–º–º—ã** —Å–ø—Ä–∞–≤–∞ (–°—É–º–º–∞ —Ç–æ–≤–∞—Ä–æ–≤, –ò—Ç–æ–≥–æ);
- **–ó–∞—â–∏—Ç–∞ –æ—Ç —Å–ª—É—á–∞–π–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π**: —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ **¬´–ò–∑–º–µ–Ω–∏—Ç—å¬ª**; –ø—Ä–∏ —É—Ö–æ–¥–µ —Å –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∫–∞–º–∏ ‚Äî ¬´–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è?¬ª.

### 4.3 –í–∏–¥–∏–º–æ—Å—Ç—å –∫–Ω–æ–ø–æ–∫ –ø–æ —Ä–æ–ª—è–º (–≤ –∫–∞—Ä—Ç–æ—á–∫–µ)
- **Sales**: ¬´–ò–∑–º–µ–Ω–∏—Ç—å¬ª, ¬´–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è¬ª, (–æ–ø—Ü.) ¬´–ó–∞–∫—Ä—ã—Ç—å –Ω–µ—É—Å–ø–µ—à–Ω–æ¬ª.
- **Manager**: ¬´–†–∞–∑—Ä–µ—à–∏—Ç—å –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—é¬ª (–Ω–∞ —à–∞–≥–µ ¬´–ù–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ¬ª), ¬´–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–ø–ª–∞—Ç—É¬ª (–Ω–∞ ¬´–ì–æ—Ç–æ–≤–æ –∫ –æ—Ç–≥—Ä—É–∑–∫–µ¬ª).
- **Logistics**: ¬´–ì–æ—Ç–æ–≤–æ –∫ –æ—Ç–≥—Ä—É–∑–∫–µ¬ª.
- –ù–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è ‚Äî `disabled` —Å –ø–æ–¥—Å–∫–∞–∑–∫–æ–π ¬´–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ –≤ –≤–∞—à–µ–π —Ä–æ–ª–∏/–Ω–∞ —ç—Ç–æ–º —à–∞–≥–µ¬ª.

---

## 5) –ü—Ä–∞–≤–∏–ª–∞ –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –°—Ç–∞—Ç—É—Å–∞

### 5.1 –¢—Ä–∏–≥–≥–µ—Ä—ã
- **Sales ‚Üí ¬´–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è¬ª (–∏–∑ ¬´–ù–æ–≤—ã–π¬ª):**  
  `amount_total ‚â§ 10000` ‚Üí `state=PICKING` (–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è), `status=EXECUTION`, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Logistics.  
  `amount_total > 10000` ‚Üí `state=APPROVAL` (–ù–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ), `status=EXECUTION`, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Manager.
- **Manager ‚Üí ¬´–†–∞–∑—Ä–µ—à–∏—Ç—å –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—é¬ª (–∏–∑ ¬´–ù–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ¬ª):**  
  `state=PICKING`, –∑–∞–¥–∞—á–∞ Logistics.
- **Logistics ‚Üí ¬´–ì–æ—Ç–æ–≤–æ –∫ –æ—Ç–≥—Ä—É–∑–∫–µ¬ª:**  
  `shipment_state=READY`, `ship_date` (required), —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Manager **¬´–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–ø–ª–∞—Ç—É¬ª**.
- **Manager ‚Üí ¬´–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–ø–ª–∞—Ç—É¬ª:**  
  `payment_state=YES` ‚Üí **System** —Å—Ç–∞–≤–∏—Ç `shipment_state=SHIPPED` –∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç `state=CLOSED` —Å `closed_success=true`, `status=CLOSED`.
- **(–û–ø—Ü.) Sales ‚Üí ¬´–ó–∞–∫—Ä—ã—Ç—å –Ω–µ—É—Å–ø–µ—à–Ω–æ¬ª:**  
  `state=CLOSED`, `closed_success=false`, `status=CLOSED`, —Ç—Ä–µ–±—É–µ—Ç—Å—è `closed_reason`.

### 5.2 –†–∞—Å—á—ë—Ç `status`
1) `state=CLOSED` ‚Üí `status=CLOSED`.  
2) –ò–Ω–∞—á–µ `state ‚àà {APPROVAL,PICKING,READY}` ‚Üí `status=EXECUTION`.  
3) –ò–Ω–∞—á–µ ‚Üí `status=OPEN`.

---

## 6) –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ (Workflows / Rune / Services)

### 6.1 Workflows
- `wf_sales_to_picking`: on action **sales.to_picking** ‚Üí –≤–µ—Ç–≤–ª–µ–Ω–∏–µ –ø–æ —Å—É–º–º–µ (10‚ÄØ000).  
- `wf_manager_allow_picking`: on action **manager.allow_picking**.  
- `wf_logistics_ready`: on action **logistics.ready**.  
- `wf_manager_confirm_payment`: on action **manager.confirm_payment** ‚Üí call service `svc_close_success`.

### 6.2 Services / Templates (—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
- `svc_notify_manager_approval(order_id)` ‚Üí —à–∞–±–ª–æ–Ω `tpl_order_approval_request` (email/webhook).  
- `svc_notify_logistics_picking(order_id)` ‚Üí `tpl_order_to_picking`.  
- `svc_notify_manager_payment(order_id)` ‚Üí `tpl_payment_confirmation_request`.  
- `svc_close_success(order_id)` ‚Äî —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `shipment_state=SHIPPED`, `state=CLOSED`, `closed_success=true`, `status=CLOSED`.

> –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ‚Äî –≤ –ø—Ä–∞–≤—É—é –ø–∞–Ω–µ–ª—å ¬´–°–æ–æ–±—â–µ–Ω–∏—è¬ª –∏/–∏–ª–∏ email/webhook.

---

## 7) –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (Roles & ACL)
- **Sales**: R/W —Å–≤–æ–∏ –∑–∞–∫–∞–∑—ã; –¥–µ–π—Å—Ç–≤–∏—è: `sales.to_picking`, `sales.close_fail`.  
- **Manager**: R/W –≤—Å–µ; –¥–µ–π—Å—Ç–≤–∏—è: `manager.allow_picking`, `manager.confirm_payment`.  
- **Logistics**: R/W –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è; –¥–µ–π—Å—Ç–≤–∏–µ: `logistics.ready`. –ù–µ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤, –Ω–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `PICKING`.  
- **System**: —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è/—Å–∫—Ä–∏–ø—Ç—ã —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ Workflow.

---

## 8) REST / Rune –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (—Å—Ö–µ–º–∞)
- REST –∞–≤—Ç–æ‚Äë—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –º–æ–¥–µ–ª–µ–π `order`, `order_item`, `client` (CRUD, —Ñ–∏–ª—å—Ç—Ä—ã).  
- Action‚Äë—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (—á–µ—Ä–µ–∑ Rune/Workflow), –∏–º–µ–Ω–∞ –¥–µ–π—Å—Ç–≤–∏–π:
  - `POST /api/order/{id}/actions/sales.to_picking`
  - `POST /api/order/{id}/actions/manager.allow_picking`
  - `POST /api/order/{id}/actions/logistics.ready`
  - `POST /api/order/{id}/actions/manager.confirm_payment`

–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ —Ä–æ–ª—å; –ø—Ä–∏ –æ—à–∏–±–∫–µ ‚Äî 409 + –∫–æ–¥ –ø—Ä–∏—á–∏–Ω—ã.

---

## 9) UX‚Äë–¥–µ—Ç–∞–ª–∏ –∫–∞—Ä—Ç–æ—á–∫–∏ (—Å–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞)
- –ø–ª–æ—Å–∫–∏–µ —Ç–æ–Ω–∫–∏–µ —Ä–∞–º–∫–∏, –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ –ø–æ–ª—è;
- ¬´–°–æ–∑–¥–∞–Ω: ‚Ä¶¬ª ‚Äî –º–∞–ª—ã–º —à—Ä–∏—Ñ—Ç–æ–º –≤ —à–∞–ø–∫–µ;
- —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–∑–∏—Ü–∏–π —Å–æ —Å–∫—Ä–æ–ª–ª–æ–º (5‚Äì10 —Å—Ç—Ä–æ–∫ –ø–æ –≤—ã—Å–æ—Ç–µ), –∫–æ–ª–æ–Ω–∫–∞ ¬´√ó¬ª ‚Äî —É–∑–∫–∞—è;
- –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ ‚Äî —Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ **–ò–∑–º–µ–Ω–∏—Ç—å** (¬´+ –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É¬ª –≤–Ω–∏–∑—É —Å–ø–∏—Å–∫–∞);
- –∫–Ω–æ–ø–∫–∞ **¬´–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è¬ª** –∞–∫—Ç–∏–≤–Ω–∞ —Ç–æ–ª—å–∫–æ –≤ `state=NEW` –∏ –≤ —Ä–µ–∂–∏–º–µ **–ò–∑–º–µ–Ω–∏—Ç—å**;
- ¬´–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è?¬ª ‚Äî **—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏** –µ—Å—Ç—å –ø—Ä–∞–≤–∫–∏ –∏ –∞–∫—Ç–∏–≤–µ–Ω —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

---

## 10) –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ (–¥–ª—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è)
- **Models**: `order`, `order_item`, `client`
- **Variables**: –∫–∞–∫ –≤ —Ä–∞–∑–¥–µ–ª–µ 3 (snake_case)
- **Views**: `orders_kanban`, `orders_list`, `clients_list`
- **User Layouts**: `order_detail`, `client_detail`
- **Workflows**: `wf_sales_to_picking`, `wf_manager_allow_picking`, `wf_logistics_ready`, `wf_manager_confirm_payment`
- **Services**: `svc_notify_manager_approval`, `svc_notify_logistics_picking`, `svc_notify_manager_payment`, `svc_close_success`
- **Templates**: `tpl_order_approval_request`, `tpl_order_to_picking`, `tpl_payment_confirmation_request`
- **Actions (UI‚Äë–∫–Ω–æ–ø–∫–∏)**: `sales.to_picking` (¬´–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è¬ª), `manager.allow_picking` (¬´–†–∞–∑—Ä–µ—à–∏—Ç—å –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—é¬ª), `logistics.ready` (¬´–ì–æ—Ç–æ–≤–æ –∫ –æ—Ç–≥—Ä—É–∑–∫–µ¬ª), `manager.confirm_payment` (¬´–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–ø–ª–∞—Ç—É¬ª), `sales.close_fail` (¬´–ó–∞–∫—Ä—ã—Ç—å –Ω–µ—É—Å–ø–µ—à–Ω–æ¬ª).

---

## 11) –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏ (MVP)
1) –í—Å–µ —Ä–æ–ª–∏ –≤–∏–¥—è—Ç –æ–¥–∏–Ω –∫–∞–Ω–±–∞–Ω; –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è ‚Äî –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã.  
2) Sales –∏–∑ ¬´–ù–æ–≤—ã–π¬ª –ø–µ—Ä–µ–≤–æ–¥–∏—Ç:  
   ‚Äî ‚â§10‚ÄØ000 ‚Üí ¬´–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è¬ª, `status=EXECUTION`, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ Logistics;  
   ‚Äî >10‚ÄØ000 ‚Üí ¬´–ù–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ¬ª, `status=EXECUTION`, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ Manager.  
3) Manager –∏–∑ ¬´–ù–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ¬ª –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –≤ ¬´–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è¬ª.  
4) Logistics –ø–µ—Ä–µ–≤–æ–¥–∏—Ç ¬´–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è ‚Üí –ì–æ—Ç–æ–≤–æ –∫ –æ—Ç–≥—Ä—É–∑–∫–µ¬ª –∏ –∑–∞–¥–∞—ë—Ç –¥–∞—Ç—É.  
5) Manager –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—É ‚Üí System —Å—Ç–∞–≤–∏—Ç ¬´–û—Ç–≥—Ä—É–∂–µ–Ω–æ¬ª –∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –∫–∞—Ä—Ç–æ—á–∫—É –≤ ¬´–ó–∞–∫–∞–∑ –∑–∞–∫—Ä—ã—Ç¬ª —Å –±–µ–π–¥–∂–µ–º **–í—ã–ø–æ–ª–Ω–µ–Ω** (`status=CLOSED`).  
6) –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: ¬´–ó–∞–∫—Ä—ã—Ç—å –Ω–µ—É—Å–ø–µ—à–Ω–æ¬ª –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø—Ä–∏—á–∏–Ω—É –∏ —É–≤–æ–¥–∏—Ç –≤ ¬´–ó–∞–∫–∞–∑ –∑–∞–∫—Ä—ã—Ç¬ª —Å –±–µ–π–¥–∂–µ–º **–ù–µ—É—Å–ø–µ—à–Ω–æ** (`status=CLOSED`).  
7) –õ—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–æ–∑–º–æ–∂–Ω—ã —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ ¬´–ò–∑–º–µ–Ω–∏—Ç—å¬ª; –ø—Ä–∏ –Ω–µ—Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –ø—Ä–∞–≤–∫–∞—Ö ‚Äî –∑–∞–ø—Ä–æ—Å ¬´–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è?¬ª.  

---

## 12) –í–Ω–µ –æ–±—ä—ë–º–∞ (—Å–µ–π—á–∞—Å)
- –†–µ–∞–ª—å–Ω—ã–µ –ø–ª–∞—Ç—ë–∂–Ω—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (–æ–ø–ª–∞—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é Manager).  
- –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –º–æ–±–∏–ª—å–Ω–∞—è –≤—ë—Ä—Å—Ç–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).  
- –ü–æ–∏—Å–∫/–∫–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤ ‚Äî –ø—Ä–æ—Å—Ç–æ–π –≤–≤–æ–¥ SKU/Name.

